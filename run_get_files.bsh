#!/bin/bash
# Before running, conda activate sbanalyst
# Cruise directory for output will be created
# *.tgz.sb documentation, etc. files will be untarred

projDir='/Users/daurin/Projects/SeaBASS/JIRA_tickets'

####################
## Setup
# NO SPACES in LIS file. LIS files are retained in projDir.

# cruise='ArcticCC_Norton_Sound_2022'
# iFile=${projDir}'/20240125_ARCTICCC_Norton_Sound_2022_HyperPro-SBA.lis'
# cruise='ArcticCC_Alakanuk_2022'
# iFile=${projDir}'/20240125_daurin_ARCTICCC_Alakanuk_2022_HyperPro.lis'
# cruise='ArcticCC_Alakanuk_2023'
# iFile=${projDir}'/20240125_ARCTICCC_Alakanuk_2023_HyperPro-SBA.lis'
# cruise='ArcticCC_Norton_Sound_2023'
# iFile=${projDir}'/20240125_ARCTICCC_Norton_Sound_2023_HyperPro-SBA.lis'

# cruise='CCNY_tzortziou_ARCTICCC_Norton_Sound_2022_AWRrrs'
# iFile=${projDir}'/20240404_kturner_CCNY_tzortziou_ARCTICCC_Norton_Sound_2022_AWRrrs.lis'
# cruise='CCNY_tzortziou_ARCTICCC_Norton_Sound_2023_AWRrrs'
# iFile=${projDir}'/20240404_kturner_CCNY_tzortziou_ARCTICCC_Norton_Sound_2023_AWRrrs.lis'


# cruise='BIOSCAPE_COASTAL_CARBON_St_Helena_Bay_2023'
# iFile=${projDir}'/20240524_kturner_CCNY_BIOSCAPE_COASTAL_CARBON_St_Helena_Bay_2023_AWR.lis'
# cruise='BIOSCAPE_COASTAL_CARBON_Walker_Bay_231108'
# iFile=${projDir}'/20240524_kturner_CCNY_BIOSCAPE_COASTAL_CARBON_Walker_Bay_231108_AWR.lis'
# cruise='BIOSCAPE_COASTAL_CARBON_Walker_Bay'
# iFile=${projDir}'/20240524_kturner_CCNY_BIOSCAPE_COASTAL_CARBON_Walker_Bay_2023_AWR.lis'

# cruise='Brewin_Superyacht_Science_2019-2020'
# iFile=${projDir}'/bbrewin_Superyacht_science_2019-2020_HyperSAS_updated.lis'
# cruise='Brewin_Superyacht_Science_2018'
# iFile=${projDir}'/Brewin_Superyacht_Science_2018_HyperInSpace_Rrs_Es_updated.lis'

# cruise='UMCES_Missouri_Reservoirs'
# iFile=${projDir}'/20240202_UMCES_Missouri_Reservoirs_RSWQ__MO_RSWQ_2023_AWR.lis'

cruise='EXPORTSNP_NASA'
iFile=${projDir}'/daurin_EXPORTSNP_HyperSAS_updated.lis'
# cruise='EXPORTSNA_NASA'
# iFile=${projDir}'/20240313_NASA_GSFC_EXPORTS_EXPORTSNA_pySAS.lis'

# cruise='EXPORTSNA_Boss'
# iFile=${projDir}'/20240112_Boss_EXPORTS_EXPORTSNA_PySAS.lis'

# cruise='Belgium_2021'
# iFile=${projDir}'/Twardowski_AQUALOOKS_Belgium_2021_AOP_rrs_Lu_Ed.lis'
# cruise='JackBlanton'

# iFile=${projDir}'/Rivero-Calle_SeaHAWK_JackBlanton_20221031_Rrs.lis'
# cruise='viirs_2019_foster'

# iFile=${projDir}'/Mannino_VIIRS_validation_2019_foster.lis'
# cruise='RSWQ_2023'
# iFile=${projDir}'/20231115_silsbe_Missouri_Reservoirs_RSWQ_MO_RSWQ_2023_radiometry.lis'

cruise='VIIRS_VALIDATION_viirs_2021_gunter'
iFile=${projDir}'/20240529_agilerson_CCNY_Gilerson_VIIRS_VALIDATION_viirs_2021_gunter_R1.lis'

echo 'Downloading for LIS file: ' $iFile
####################

python /Users/daurin/GitRepos/sbanalyst/get_files.py --ifile=$iFile

# Make a folder and move new data
if [ ! -d "${projDir}/${cruise}" ]; then
    mkdir ${projDir}/${cruise}
fi
mv *.sb ${projDir}/${cruise}/

# Tidy up and create a filelist.txt for use in QC scripts
for file in ${projDir}/${cruise}/*.*; do
    if [[ $file == *.tgz.sb ]];then
        echo 'Renaming/Untarzipping ' $file
        newFilename=${file/.sb/}
        mv $file $newFilename
        tar -xvf $newFilename -C ${projDir}/${cruise}
    fi
done
ls ${projDir}/${cruise}/*.sb > ${projDir}/${cruise}/filelist.txt